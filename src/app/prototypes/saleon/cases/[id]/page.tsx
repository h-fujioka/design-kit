"use client";

import casesData from '@/components/prototypes/saleon/data/cases.json';
import { FullWidthBreadcrumb } from '@/components/shared/full-width-breadcrumb';
import { SaleOnPageHeader } from '@/components/shared/saleon-page-header';
import { SaleOnSidebar } from '@/components/shared/saleon-sidebar';
import { Button } from '@/components/ui/button';
import { Card, CardContent } from '@/components/ui/card';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Textarea } from '@/components/ui/textarea';
import { Timeline, TimelineItem } from '@/components/ui/timeline';
import { BarChart3, Bot, Building, Calendar, CheckCircle, CheckSquare, ExternalLink, File, FileText, Info, Link, Mail, MessageCircle, Newspaper, User } from 'lucide-react';
import { use, useState } from 'react';

const navigationItems = [
  { id: 'info', label: 'Ê°à‰ª∂ÊÉÖÂ†±', icon: Info },
  { id: 'summary', label: 'Ê°à‰ª∂Ë¶ÅÁ¥Ñ', icon: FileText },
  { id: 'files', label: '„Éï„Ç°„Ç§„É´', icon: File },
  { id: 'links', label: '„É™„É≥„ÇØ', icon: Link },
  { id: 'company', label: '‰ºÅÊ•≠ÊÉÖÂ†±', icon: Building },
  { id: 'news', label: '„Éã„É•„Éº„Çπ', icon: Newspaper },
  { id: 'tasks', label: '„Çø„Çπ„ÇØ', icon: CheckSquare },
];

interface CaseDetailPageProps {
  params: Promise<{
    id: string;
  }>;
}

export default function CaseDetailPage({ params }: CaseDetailPageProps) {
  // params„ÇíPromise„Åã„ÇâÂèñÂæó
  const { id } = use(params);
  const [selectedTab, setSelectedTab] = useState('info');
  
  // Ê°à‰ª∂„Éá„Éº„Çø„ÇíÂèñÂæó
  const caseData = casesData.find(caseItem => caseItem.id === id) || {
    id: 'N/A',
    title: 'N/A',
    company: 'N/A',
    customerContact: 'N/A',
    salesRep: {
      name: 'N/A',
      avatar: '??'
    }
  };
  
  // Ê°à‰ª∂„ÅåË¶ã„Å§„Åã„Çâ„Å™„ÅÑÂ†¥Âêà„ÅÆ„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ
  if (!caseData) {
    return (
      <div className="h-[calc(100vh-3.5rem)] flex items-center justify-center">
        <div className="text-center">
          <h1 className="text-2xl font-bold text-muted-foreground mb-4">
            Ê°à‰ª∂„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì
          </h1>
          <Link href="/prototypes/saleon/cases">
            <button className="px-4 py-2 bg-brand-600 text-white rounded-md hover:bg-brand-700 transition-colors">
              Ê°à‰ª∂‰∏ÄË¶ß„Å´Êàª„Çã
            </button>
          </Link>
        </div>
      </div>
    );
  }

  return (
    <div 
      className="h-[calc(100vh-3.5rem)] flex"
      style={{ backgroundColor: 'oklch(0.97 0.005 240)' }}
    >
      {/* Â∑¶„Çµ„Ç§„Éâ„Éê„Éº - „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */}
      <SaleOnSidebar activeItem="cases" />

      {/* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Ç®„É™„Ç¢ */}
      <main 
        className="flex-1 overflow-auto overflow-x-hidden"
        style={{ backgroundColor: 'oklch(0.97 0.005 240)' }}
      >
        <div className="p-6 overflow-x-hidden">
          <div className="polaris-section">
            {/* „Éë„É≥„ÇØ„Ç∫„Ç®„É™„Ç¢ */}
            <FullWidthBreadcrumb
              size="sm"
              items={[
                { label: '„Éõ„Éº„É†', href: '/prototypes/saleon' },
                { label: 'Ê°à‰ª∂‰∏ÄË¶ß', href: '/prototypes/saleon/cases' },
                { label: caseData?.title || 'N/A' }
              ]}
            />
            
                <div className="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pt-2">
              <div className="space-y-6">
                {/* „Éö„Éº„Ç∏„Éò„ÉÉ„ÉÄ„Éº */}
                <SaleOnPageHeader
                  title={caseData?.title || 'N/A'}
                  actions={
                    <>
                      <Button variant="outline" size="sm">
                        ÂÖ±Êúâ
                      </Button>
                      <Button variant="outline" size="sm">
                        <span className="text-sm">üîñ</span>
                      </Button>
                    </>
                  }
                />

                {/* 2„Ç´„É©„É†„É¨„Ç§„Ç¢„Ç¶„Éà */}
                <div className="grid grid-cols-1 lg:grid-cols-10 gap-400">
                  {/* Â∑¶ÂÅ¥Ôºö„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥Ôºà6/10ÂπÖÔºâ */}
                  <div className="lg:col-span-6">
                    <div className="bg-white rounded-lg border border-gray-200">
                      <div className="p-400">
                        
                        <Tabs defaultValue="timeline" className="space-y-300">
                          <TabsList variant="underline" className="grid w-full grid-cols-3">
                            <TabsTrigger variant="underline" value="timeline" className="flex items-center gap-2">
                              <Calendar className="h-4 w-4" />
                              „Çø„Ç§„É†„É©„Ç§„É≥
                            </TabsTrigger>
                            <TabsTrigger variant="underline" value="slack" className="flex items-center gap-2">
                              <MessageCircle className="h-4 w-4" />
                              Slack
                            </TabsTrigger>
                            <TabsTrigger variant="underline" value="email" className="flex items-center gap-2">
                              <Mail className="h-4 w-4" />
                              „É°„Éº„É´
                            </TabsTrigger>
                          </TabsList>
                          
                          <TabsContent value="timeline" className="space-y-400">
                            <Timeline>
                              <TimelineItem
                                title="ÊúÄÁµÇÊèêÊ°à„Éü„Éº„ÉÜ„Ç£„É≥„Ç∞"
                                type="„Éü„Éº„ÉÜ„Ç£„É≥„Ç∞"
                                assignee="Áî∞‰∏≠Âçö‰∏Ä"
                                summary="ÊúÄÁµÇÊèêÊ°à„Å®ROIË™¨Êòé„ÄÇÂ•ëÁ¥ÑÁ∑†Áµê„Å´Âêë„Åë„ÅüÊúÄÁµÇÁ¢∫Ë™ç„ÄÇ"
                                date="2024/07/20"
                                icon={<Calendar className="h-4 w-4" />}
                                iconColor="text-blue-600"
                                iconBgColor="bg-blue-100"
                              />
                              
                              <TimelineItem
                                title="Ê≥ïÂãôÈÉ®Èï∑„Åã„Çâ„ÅÆËøΩÂä†Ë¶Å‰ª∂‰æùÈ†º"
                                type="Slack"
                                assignee="Áî∞‰∏≠Ê¨°ÈÉé„Éª#abc-legal„Éª3‰ª∂"
                                summary="Â•ëÁ¥ÑÊõ∏„É¨„Éì„É•„ÉºÊ©üËÉΩ„ÅÆËøΩÂä†Ë¶Å‰ª∂Á¢∫Ë™ç„ÄÇÁ§æÂÜÖË¶èÂÆö„Å®„ÅÆËá™ÂãïÁÖßÂêàÊ©üËÉΩ„ÇíËøΩÂä†Â∏åÊúõ„ÄÇ"
                                date="2024/07/19"
                                icon={<MessageCircle className="h-4 w-4" />}
                                iconColor="text-purple-600"
                                iconBgColor="bg-purple-100"
                              />
                              
                              <TimelineItem
                                title="ÊèêÊ°àÊõ∏„É¨„Éì„É•„ÉºÂÆå‰∫Ü"
                                type="„É°„Éº„É´"
                                assignee="‰ΩêËó§Â§™ÈÉé"
                                summary="ÂàùÂõûÊèêÊ°àÊõ∏„ÅÆ„É¨„Éì„É•„Éº„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü„ÄÇ„ÅÑ„Åè„Å§„Åã„ÅÆ‰øÆÊ≠£ÁÇπ„Å´„Å§„ÅÑ„Å¶„ÅîÈÄ£Áµ°„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ"
                                date="2024/07/18"
                                icon={<Mail className="h-4 w-4" />}
                                iconColor="text-green-600"
                                iconBgColor="bg-green-100"
                              />
                              
                              <TimelineItem
                                title="Á´∂ÂêàÂàÜÊûê„É¨„Éù„Éº„Éà"
                                type="ÂàÜÊûê"
                                assignee="Sela"
                                summary="Á´∂Âêà‰ªñÁ§æ„ÅÆÊ©üËÉΩÊØîËºÉ„Å®‰æ°Ê†ºÂàÜÊûê„ÇíÂÆüÊñΩ„ÄÇÊàë„ÄÖ„ÅÆÂÑ™‰ΩçÊÄß„ÇíÊòéÁ¢∫Âåñ„ÄÇ"
                                date="2024/07/17"
                                icon={<BarChart3 className="h-4 w-4" />}
                                iconColor="text-orange-600"
                                iconBgColor="bg-orange-100"
                              />
                              
                              <TimelineItem
                                title="AIÁîüÊàêÊèêÊ°àÊõ∏"
                                type="AIÁîüÊàê"
                                assignee="Sela"
                                summary="ÈÅéÂéª„ÅÆÈ°û‰ººÊ°à‰ª∂„Éá„Éº„Çø„ÇíÂü∫„Å´„ÄÅ„Ç´„Çπ„Çø„Éû„Ç§„Ç∫„Åï„Çå„ÅüÊèêÊ°àÊõ∏„ÇíËá™ÂãïÁîüÊàê„Åó„Åæ„Åó„Åü„ÄÇ"
                                date="2024/07/16"
                                icon={<Bot className="h-4 w-4" />}
                                iconColor="text-indigo-600"
                                iconBgColor="bg-indigo-100"
                              />
                              
                              <TimelineItem
                                title="Â•ëÁ¥ÑÊù°‰ª∂ÊâøË™ç"
                                type="ÊâøË™çÊ∏à„Åø"
                                assignee="‰ΩêËó§ÁæéÂí≤"
                                summary="Ê≥ïÂãôÈÉ®„Å´„Çà„ÇãÂ•ëÁ¥ÑÊù°‰ª∂„ÅÆÊúÄÁµÇÊâøË™ç„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü„ÄÇ"
                                date="2024/07/15"
                                icon={<CheckCircle className="h-4 w-4" />}
                                iconColor="text-green-600"
                                iconBgColor="bg-green-100"
                              />
                            </Timeline>
                            
                            {/* „Ç≥„É°„É≥„ÉàÂÖ•ÂäõÊ¨Ñ */}
                            <div className="border-t pt-6">
                              <div className="flex gap-3">
                                <div className="w-8 h-8 bg-brand-100 rounded-full flex items-center justify-center">
                                  <User className="h-4 w-4 text-brand-600" />
                                </div>
                                <div className="flex-1">
                                  <Textarea 
                                    variant="brand"
                                    placeholder="„Ç≥„É°„É≥„Éà„ÇíËøΩÂä†..."
                                    className="min-h-[80px] resize-none"
                                  />
                                  <div className="flex justify-end mt-2">
                                    <Button variant="brand" size="sm">ÈÄÅ‰ø°</Button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </TabsContent>
                          
                          <TabsContent value="slack" className="space-y-400">
                            <div className="text-center py-8 text-muted-foreground">
                              Slack„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô
                            </div>
                          </TabsContent>
                          
                          <TabsContent value="email" className="space-y-400">
                            <div className="text-center py-8 text-muted-foreground">
                              „É°„Éº„É´„ÅÆÂ±•Ê≠¥„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô
                            </div>
                          </TabsContent>
                        </Tabs>
                      </div>
                    </div>
                  </div>
                  
                  {/* Âè≥ÂÅ¥ÔºöÂü∫Êú¨ÊÉÖÂ†±Ôºà4/10ÂπÖÔºâ */}
                  <div className="lg:col-span-4">
                    <Card className="bg-white">
                      <CardContent>
                        <div className="space-y-400">
                          {/* „É¨„Ç§„Ç¢„Ç¶„Éà */}
                          <div className="flex gap-300">
                            {/* Âü∫Êú¨ÊÉÖÂ†±„Ç®„É™„Ç¢ */}
                            <div className="flex-1">
                              <div className="space-y-300">
                                {/* „Çø„Ç§„Éà„É´ */}
                                <div>
                                  <h3 className="text-lg font-semibold">
                                    {navigationItems.find(item => item.id === selectedTab)?.label || 'Âü∫Êú¨ÊÉÖÂ†±'}
                                  </h3>
                                </div>
                                <div className="space-y-100">
                                  <div className="text-sm text-muted-foreground font-bold">Ê°à‰ª∂ID</div>
                                  <div className="text-sm font-medium">{caseData?.id || 'N/A'}</div>
                                </div>
                                <div className="space-y-100">
                                  <div className="text-sm text-muted-foreground font-bold">Ê°à‰ª∂ÊãÖÂΩìËÄÖ</div>
                                  <div className="flex items-center gap-200">
                                    <div className="w-6 h-6 bg-brand-100 rounded-full flex items-center justify-center text-xs font-medium text-brand-800">
                                      {caseData?.salesRep?.avatar || '??'}
                                    </div>
                                    <span className="text-sm">{caseData?.salesRep?.name || 'N/A'}</span>
                                  </div>
                                </div>
                                <div className="space-y-100">
                                  <div className="text-sm text-muted-foreground font-bold">Ê°à‰ª∂Èñ¢‰∏éËÄÖ</div>
                                  <div className="flex items-center gap-200">
                                    <div className="w-6 h-6 bg-green-100 rounded-full flex items-center justify-center text-xs font-medium text-green-800">
                                      HT
                                    </div>
                                    <span className="text-sm">Hirokazu Tanaka</span>
                                  </div>
                                </div>
                                <div className="space-y-100">
                                  <div className="text-sm text-muted-foreground font-bold">‰ºÅÊ•≠Âêç</div>
                                  <div className="text-sm font-medium">{caseData?.company || 'N/A'}</div>
                                </div>
                                <div className="space-y-100">
                                  <div className="text-sm text-muted-foreground font-bold">È°ßÂÆ¢ÊãÖÂΩìËÄÖ</div>
                                  <div className="text-sm font-medium">{caseData?.customerContact || 'N/A'}</div>
                                </div>
                                <div className="space-y-100">
                                  <div className="text-sm text-muted-foreground font-bold">È°ßÂÆ¢Èñ¢‰øÇËÄÖ</div>
                                  <div className="space-y-1">
                                    <div className="text-sm">‰ΩêËó§‰∫åÈÉéÔºà‰∏ªÊãÖÂΩìÔºâ</div>
                                    <div className="text-sm">Â±±Áî∞Ëä±Â≠êÔºàÂâØÊãÖÂΩìÔºâ</div>
                                  </div>
                                </div>
                                <div className="space-y-100">
                                  <div className="text-sm text-muted-foreground font-bold">„Éó„É≠„Ç∏„Çß„ÇØ„Éà</div>
                                  <div className="flex items-center gap-200">
                                    <span className="text-sm">LegalOn CloudÂ∞éÂÖ•</span>
                                    <Button variant="outline" size="sm">
                                      <ExternalLink className="h-3 w-3" />
                                    </Button>
                                  </div>
                                </div>
                                <div className="space-y-100">
                                  <div className="text-sm text-muted-foreground font-bold">Ë™¨Êòé</div>
                                  <p className="text-sm text-muted-foreground">
                                    {caseData?.title || 'N/A'}„Å´Èñ¢„Åô„ÇãÊ°à‰ª∂„Åß„Åô„ÄÇ{caseData?.company || 'N/A'}Êßò„Å®„ÅÆÂ•ëÁ¥Ñ„Å´Èñ¢„Åô„ÇãÊ•≠Âãô„ÇíÈÄ≤„ÇÅ„Å¶„ÅÑ„Åæ„Åô„ÄÇ
                                    Ë©≥Á¥∞„Å™ÂÜÖÂÆπ„Å´„Å§„ÅÑ„Å¶„ÅØ„ÄÅÊãÖÂΩìËÄÖ„Åæ„Åß„ÅäÂïè„ÅÑÂêà„Çè„Åõ„Åè„Å†„Åï„ÅÑ„ÄÇ
                                  </p>
                                </div>
                              </div>
                            </div>
                            
                            {/* „Ç¢„Ç§„Ç≥„É≥„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Ç®„É™„Ç¢ */}
                            <div className="flex justify-center">
                              <div className="flex flex-col gap-100">
                                {navigationItems.map((item) => {
                                  const IconComponent = item.icon;
                                  return (
                                    <button 
                                      key={item.id}
                                      className={`w-10 h-10 flex items-center justify-center hover:bg-gray-50 rounded-lg transition-colors relative group ${
                                        selectedTab === item.id ? 'bg-gray-100' : ''
                                      }`}
                                      title={item.label}
                                      onClick={() => setSelectedTab(item.id)}
                                    >
                                      <IconComponent className="h-5 w-5 text-gray-600" />
                                      <div className="absolute left-full top-1/2 transform -translate-y-1/2 ml-200 px-200 py-100 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">
                                        {item.label}
                                      </div>
                                    </button>
                                  );
                                })}
                              </div>
                            </div>
                          </div>
                          
                          {/* ‰ΩúÊ•≠Â±•Ê≠¥„Éª„Ç≥„É°„É≥„Éà„Çø„ÉñÔºà2„Ç´„É©„É†„ÅÆ‰∏ã„Å´ÈÖçÁΩÆÔºâ */}
                          <div className="space-y-300 border-t">
                            <Tabs defaultValue="history" className="w-full">
                              <TabsList variant="default" className="grid w-full grid-cols-2">
                                <TabsTrigger variant="default" value="history">‰ΩúÊ•≠Â±•Ê≠¥</TabsTrigger>
                                <TabsTrigger variant="default" value="comments">„Ç≥„É°„É≥„Éà</TabsTrigger>
                              </TabsList>
                              
                              <TabsContent value="history" className="space-y-200 mt-300">
                                <div className="space-y-200">
                                  <div className="flex items-start gap-200">
                                    <div className="w-8 h-8 bg-brand-100 rounded-full flex items-center justify-center">
                                      <User className="h-4 w-4 text-brand-600" />
                                    </div>
                                    <div className="flex-1">
                                      <div className="flex items-center gap-200 mb-100">
                                        <span className="text-sm font-medium">Áî∞‰∏≠Â§™ÈÉé</span>
                                        <span className="text-xs text-muted-foreground">2ÊôÇÈñìÂâç</span>
                                      </div>
                                      <p className="text-sm text-muted-foreground">
                                        È°ßÂÆ¢„Å®„ÅÆÂàùÂõûÈù¢Ë´á„ÇíÂÆüÊñΩ„Åó„Åæ„Åó„Åü„ÄÇË¶Å‰ª∂„ÅÆË©≥Á¥∞„ÇíÁ¢∫Ë™ç„Åó„ÄÅÊèêÊ°àÊõ∏„ÅÆÊ∫ñÂÇô„ÇíÈÄ≤„ÇÅ„Åæ„Åô„ÄÇ
                                      </p>
                                    </div>
                                  </div>
                                  
                                  <div className="flex items-start gap-200">
                                    <div className="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                      <CheckCircle className="h-4 w-4 text-green-600" />
                                    </div>
                                    <div className="flex-1">
                                      <div className="flex items-center gap-200 mb-100">
                                        <span className="text-sm font-medium">‰ΩêËó§Ëä±Â≠ê</span>
                                        <span className="text-xs text-muted-foreground">1Êó•Ââç</span>
                                      </div>
                                      <p className="text-sm text-muted-foreground">
                                        ÊèêÊ°àÊõ∏„ÅÆÂàùÁ®ø„Çí‰ΩúÊàê„Åó„Åæ„Åó„Åü„ÄÇ„É¨„Éì„É•„Éº„ÅÆÊ∫ñÂÇô„ÅåÊï¥„ÅÑ„Åæ„Åó„Åü„ÄÇ
                                      </p>
                                    </div>
                                  </div>
                                </div>
                              </TabsContent>
                              
                              <TabsContent value="comments" className="space-y-200 mt-300">
                                <div className="space-y-200">
                                  <div className="flex items-start gap-200">
                                    <div className="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                      <MessageCircle className="h-4 w-4 text-blue-600" />
                                    </div>
                                    <div className="flex-1">
                                      <div className="flex items-center gap-200 mb-100">
                                        <span className="text-sm font-medium">Â±±Áî∞Ê¨°ÈÉé</span>
                                        <span className="text-xs text-muted-foreground">3ÊôÇÈñìÂâç</span>
                                      </div>
                                      <p className="text-sm text-muted-foreground">
                                        ‰∫àÁÆó„Å´„Å§„ÅÑ„Å¶Á¢∫Ë™ç„ÅåÂøÖË¶Å„Åß„Åô„ÄÇÊ¨°Âõû„ÅÆ‰ºöË≠∞„ÅßË©≥Á¥∞„ÇíË©±„ÅóÂêà„ÅÑ„Åæ„Åó„Çá„ÅÜ„ÄÇ
                                      </p>
                                    </div>
                                  </div>
                                  
                                  <div className="flex items-start gap-200">
                                    <div className="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                      <Mail className="h-4 w-4 text-purple-600" />
                                    </div>
                                    <div className="flex-1">
                                      <div className="flex items-center gap-200 mb-100">
                                        <span className="text-sm font-medium">Èà¥Êú®‰∏ÄÈÉé</span>
                                        <span className="text-xs text-muted-foreground">5ÊôÇÈñìÂâç</span>
                                      </div>
                                      <p className="text-sm text-muted-foreground">
                                        È°ßÂÆ¢„Åã„ÇâËøΩÂä†„ÅÆË¶Å‰ª∂„ÅåÂ±ä„Åç„Åæ„Åó„Åü„ÄÇÂÜÖÂÆπ„ÇíÁ¢∫Ë™ç„Åó„Å¶ÂØæÂøúÊñπÈáù„ÇíÊ§úË®é„Åó„Åæ„Åô„ÄÇ
                                      </p>
                                    </div>
                                  </div>
                                </div>
                              </TabsContent>
                            </Tabs>
                            
                            {/* ÊäïÁ®ø„Éï„Ç©„Éº„É† */}
                            <div className="border-t">
                              <div className="flex gap-200 pt-300">
                                <div className="w-8 h-8 bg-brand-100 rounded-full flex items-center justify-center">
                                  <User className="h-4 w-4 text-brand-600" />
                                </div>
                                <div className="flex-1 space-y-200">
                                  <Textarea 
                                    variant="brand"
                                    placeholder="‰ΩúÊ•≠ÂÜÖÂÆπ„ÇÑ„Ç≥„É°„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ..."
                                    className="min-h-[80px] resize-none"
                                  />
                                  <div className="flex justify-end">
                                    <Button variant="brand" size="sm">ÊäïÁ®ø</Button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </CardContent>
                    </Card>
                  </div>
                </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
  );
}
